#ifndef _KRNL_MSR_H
#define _KRNL_MSR_H 1

#include <stddef.h>

#ifdef __cplusplus
extern "C"
{
#endif // __cplusplus

/* Architectually Defined MSRs
*/
#define MSR_IA32_P5_MC_ADDR                 0x00
#define MSR_IA32_P5_MC_TYPE                 0x01
#define MSR_IA32_MONITOR_FILTER_SIZE        0x06
#define MSR_IA32_TIME_STAMP_COUNTER         0x10
#define MSR_IA32_PLATFORM_ID                0x17
#define MSR_IA32_APIC_BASE                  0x1B
#define MSR_IA32_FEATURE_CONTROL            0x3A
#define MSR_IA32_TSC_ADJUST                 0x3B
#define MSR_IA32_SPEC_CTRL                  0x48
#define MSR_IA32_PREF_CMD                   0x49
#define MSR_IA32_BIOS_UPDT_TRIG             0x79
#define MSR_IA32_BIOS_SIGN_ID               0x8B
#define MSR_IA32_SGXLEPUBKEYHASH0           0x8C
#define MSR_IA32_SGXLEPUBKEYHASH1           0x8D
#define MSR_IA32_SGXLEPUBKEYHASH2           0x8E
#define MSR_IA32_SGXLEPUBKEYHASH3           0x8F
#define MSR_IA32_SMM_MONITOR_CTL            0x9B
#define MSR_IA32_SMBASE                     0x9E
#define MSR_IA32_PMC0                       0xC1
#define MSR_IA32_PMC1                       0xC2
#define MSR_IA32_PMC2                       0xC3
#define MSR_IA32_PMC3                       0xC4
#define MSR_IA32_PMC4                       0xC5
#define MSR_IA32_PMC5                       0xC6
#define MSR_IA32_PMC6                       0xC7
#define MSR_IA32_PMC7                       0xC8
#define MSR_IA32_CORE_CAPABILITIES          0xCF
#define MSR_IA32_UMWAIT_CONTROL             0xE1
#define MSR_IA32_MPERF                      0xE7
#define MSR_IA32_APERF                      0xE8
#define MSR_IA32_MTRRCAP                    0xFE
#define MSR_IA32_ARCH_CAPABILITIES          0x10A
#define MSR_IA32_FLUSH_CMD                  0x10B
#define MSR_IA32_TSX_CTRL                   0x122
#define MSR_IA32_SYSENTER_CS                0x174
#define MSR_IA32_SYSENTER_ESP               0x175
#define MSR_IA32_SYSENTER_EIP               0x176
#define MSR_IA32_MCG_CAP                    0x179
#define MSR_IA32_MCG_STATUS                 0x17A
#define MSR_IA32_MCG_CTL                    0x17B

/* 180H-185H Reserved
*/
#define MSR_IA32_PERFEVRSELO                0x186
#define MSR_IA32_PERFEVRSEL1                0x187
#define MSR_IA32_PERFEVRSEL2                0x188
#define MSR_IA32_PERFEVRSEL3                0x189

/* 189H-197H Reserved
*/
#define MSR_IA32_PERF_STATUS                0x198
#define MSR_IA32_PERF_CTL                   0x199
#define MSR_IA32_CLOCK_MODULATION           0x19A
#define MSR_IA32_THERM_INTERRUPT            0x19B
#define MSR_IA32_THERM_STATUS               0x19C
#define MSR_IA32_MISC_ENABLE                0x1A0
#define MSR_IA32_ENERGY_PERF_BIAS           0x1B0
#define MSR_IA32_PACKAGE_THERM_STATUS       0x1B1
#define MSR_IA32_PACKAGE_THERM_INTERRUPT    0x1B2
#define MSR_IA32_DEBUGCTL                   0x1D9
#define MSR_IA32_SMRR_PHYSBASE              0x1F2
#define MSR_IA32_SMRR_PHYSMASK              0x1F3
#define MSR_IA32_PLATFORM_DCA_CAP           0x1F8
#define MSR_IA32_CPU_DCA_CAP                0x1F9
#define MSR_IA32_DCA_O_CAP                  0x1FA
#define MSR_IA32_MTRR_PHYSBASE0             0x200
#define MSR_IA32_MTRR_PHYSMASK0             0x201
#define MSR_IA32_MTRR_PHYSBASE1             0x202
#define MSR_IA32_MTRR_PHYSMASK1             0x203
#define MSR_IA32_MTRR_PHYSBASE2             0x204
#define MSR_IA32_MTRR_PHYSMASK2             0x205
#define MSR_IA32_MTRR_PHYSBASE3             0x206
#define MSR_IA32_MTRR_PHYSMASK3             0x207
#define MSR_IA32_MTRR_PHYSBASE4             0x208
#define MSR_IA32_MTRR_PHYSMASK4             0x209
#define MSR_IA32_MTRR_PHYSBASE5             0x20A
#define MSR_IA32_MTRR_PHYSMASK5             0x20B
#define MSR_IA32_MTRR_PHYSBASE6             0x20C
#define MSR_IA32_MTRR_PHYSMASK6             0x20D
#define MSR_IA32_MTRR_PHYSBASE7             0x20E
#define MSR_IA32_MTRR_PHYSMASK7             0x20F
#define MSR_IA32_MTRR_PHYSBASE8             0x210
#define MSR_IA32_MTRR_PHYSMASK8             0x211
#define MSR_IA32_MTRR_PHYSBASE9             0x212
#define MSR_IA32_MTRR_PHYSMASK9             0x213
#define MSR_IA32_MTRR_FIX64K_00000          0x250
#define MSR_IA32_MTRR_FIX64K_80000          0x258
#define MSR_IA32_MTRR_FIX64K_A0000          0x259
#define MSR_IA32_MTRR_FIX4K_C0000           0x268
#define MSR_IA32_MTRR_FIX4K_C8000           0x269
#define MSR_IA32_MTRR_FIX4K_D0000           0x26A
#define MSR_IA32_MTRR_FIX4K_D8000           0x28B
#define MSR_IA32_MTRR_FIX4K_E0000           0x26C
#define MSR_IA32_MTRR_FIX4K_E8000           0x26D
#define MSR_IA32_MTRR_FIX4K_F0000           0x26E
#define MSR_IA32_MTRR_FIX4K_F8000           0x26F
#define MSR_IA32_PAT                        0x277
#define MSR_IA32_MC0_CTL2                   0x280
#define MSR_IA32_MC1_CTL2                   0x281
#define MSR_IA32_MC2_CTL2                   0x282
#define MSR_IA32_MC3_CTL2                   0x283
#define MSR_IA32_MC4_CTL2                   0x284
#define MSR_IA32_MC5_CTL2                   0x285
#define MSR_IA32_MC6_CTL2                   0x286
#define MSR_IA32_MC7_CTL2                   0x287
#define MSR_IA32_MC8_CTL2                   0x288
#define MSR_IA32_MC9_CTL2                   0x289
#define MSR_IA32_MC10_CTL2                  0x28A
#define MSR_IA32_MC11_CTL2                  0x28B
#define MSR_IA32_MC12_CTL2                  0x28C
#define MSR_IA32_MC13_CTL2                  0x28D
#define MSR_IA32_MC14_CTL2                  0x28E
#define MSR_IA32_MC15_CTL2                  0x28F
#define MSR_IA32_MC16_CTL2                  0x290
#define MSR_IA32_MC17_CTL2                  0x291
#define MSR_IA32_MC18_CTL2                  0x292
#define MSR_IA32_MC19_CTL2                  0x293
#define MSR_IA32_MC20_CTL2                  0x294
#define MSR_IA32_MC21_CTL2                  0x295
#define MSR_IA32_MC22_CTL2                  0x296
#define MSR_IA32_MC23_CTL2                  0x297
#define MSR_IA32_MC24_CTL2                  0x298
#define MSR_IA32_MC25_CTL2                  0x299
#define MSR_IA32_MC26_CTL2                  0x29A
#define MSR_IA32_MC27_CTL2                  0x29B
#define MSR_IA32_MC28_CTL2                  0x29C
#define MSR_IA32_MC29_CTL2                  0x29D
#define MSR_IA32_MC30_CTL2                  0x29E
#define MSR_IA32_MC31_CTL2                  0x29F
#define MSR_IA32_MTRR_DEF_TYPE              0x2FF
#define MSR_IA32_FIXED_CTR0                 0x309
#define MSR_IA32_FIXED_CTR1                 0x30A
#define MSR_IA32_FIXED_CTR2                 0x30B
#define MSR_IA32_PERF_CAPABILITIES          0x345
#define MSR_IA32_FIXED_CTR_CTRL             0x38D
#define MSR_IA32_PERF_GLOBAL_STATUS         0x38E
#define MSR_IA32_PERF_GLOBAL_CRTL           0x38F
#define MSR_IA32_PERF_GLOBAL_OVF_CTRL       0x390
#define MSR_IA32_PERF_GLOBAL_STATUS_RESET   0x390
#define MSR_IA32_PERF_GLOBAL_STATUS_SET     0x391
#define MSR_IA32_PERF_GLOBAL_INUSE          0x392
#define MSR_IA32_PEBS_ENABLE                0x3F1
#define MSR_IA32_MC0_CTL                    0x400
#define MSR_IA32_MC0_STATUS                 0x401
#define MSR_IA32_MC0_ADDR                   0x402
#define MSR_IA32_MC0_MISC                   0x403
#define MSR_IA32_MC1_CTL                    0x404
#define MSR_IA32_MC1_STATUS                 0x405
#define MSR_IA32_MC1_ADDR                   0x406
#define MSR_IA32_MC1_MISC                   0x407
#define MSR_IA32_MC2_CTL                    0x408
#define MSR_IA32_MC2_STATUS                 0x409
#define MSR_IA32_MC2_ADDR                   0x40A
#define MSR_IA32_MC2_MISC                   0x40B
#define MSR_IA32_MC3_CTL                    0x40C
#define MSR_IA32_MC3_STATUS                 0x40D
#define MSR_IA32_MC3_ADDR                   0x40E
#define MSR_IA32_MC3_MISC                   0x40F
#define MSR_IA32_MC4_CTL                    0x410
#define MSR_IA32_MC4_STATUS                 0x411
#define MSR_IA32_MC4_ADDR                   0x412
#define MSR_IA32_MC4_MISC                   0x413
#define MSR_IA32_MC5_CTL                    0x414
#define MSR_IA32_MC5_STATUS                 0x415
#define MSR_IA32_MC5_ADDR                   0x416
#define MSR_IA32_MC5_MISC                   0x417
#define MSR_IA32_MC6_CTL                    0x418
#define MSR_IA32_MC6_STATUS                 0x419
#define MSR_IA32_MC6_ADDR                   0x41A
#define MSR_IA32_MC6_MISC                   0x41B
#define MSR_IA32_MC7_CTL                    0x41C
#define MSR_IA32_MC7_STATUS                 0x41D
#define MSR_IA32_MC7_ADDR                   0x41E
#define MSR_IA32_MC7_MISC                   0x41F
#define MSR_IA32_MC8_CTL                    0x420
#define MSR_IA32_MC8_STATUS                 0x421
#define MSR_IA32_MC8_ADDR                   0x422
#define MSR_IA32_MC8_MISC                   0x423
#define MSR_IA32_MC9_CTL                    0x424
#define MSR_IA32_MC9_STATUS                 0x425
#define MSR_IA32_MC9_ADDR                   0x426
#define MSR_IA32_MC9_MISC                   0x427
#define MSR_IA32_MC10_CTL                   0x428
#define MSR_IA32_MC10_STATUS                0x429
#define MSR_IA32_MC10_ADDR                  0x42A
#define MSR_IA32_MC10_MISC                  0x42B
#define MSR_IA32_MC11_CTL                   0x42C
#define MSR_IA32_MC11_STATUS                0x42D
#define MSR_IA32_MC11_ADDR                  0x42E
#define MSR_IA32_MC11_MISC                  0x42F
#define MSR_IA32_MC12_CTL                   0x430
#define MSR_IA32_MC12_STATUS                0x431
#define MSR_IA32_MC12_ADDR                  0x432
#define MSR_IA32_MC12_MISC                  0x433
#define MSR_IA32_MC13_CTL                   0x434
#define MSR_IA32_MC13_STATUS                0x435
#define MSR_IA32_MC13_ADDR                  0x436
#define MSR_IA32_MC13_MISC                  0x437
#define MSR_IA32_MC14_CTL                   0x438
#define MSR_IA32_MC14_STATUS                0x439
#define MSR_IA32_MC14_ADDR                  0x43A
#define MSR_IA32_MC14_MISC                  0x43B
#define MSR_IA32_MC15_CTL                   0x43C
#define MSR_IA32_MC15_STATUS                0x43D
#define MSR_IA32_MC15_ADDR                  0x43E
#define MSR_IA32_MC15_MISC                  0x43F
#define MSR_IA32_MC16_CTL                  0x440
#define MSR_IA32_MC16_STATUS                0x441
#define MSR_IA32_MC16_ADDR                  0x442
#define MSR_IA32_MC16_MISC                  0x443
#define MSR_IA32_MC17_CTL                   0x444
#define MSR_IA32_MC17_STATUS                0x445
#define MSR_IA32_MC17_ADDR                  0x446
#define MSR_IA32_MC17_MISC                  0x447
#define MSR_IA32_MC18_CTL                   0x448
#define MSR_IA32_MC18_STATUS                0x449
#define MSR_IA32_MC18_ADDR                  0x44A
#define MSR_IA32_MC18_MISC                  0x44B
#define MSR_IA32_MC19_CTL                   0x44C
#define MSR_IA32_MC19_STATUS                0x44D
#define MSR_IA32_MC19_ADDR                  0x44E
#define MSR_IA32_MC19_MISC                  0x44F
#define MSR_IA32_MC20_CTL                   0x450
#define MSR_IA32_MC20_STATUS                0x451
#define MSR_IA32_MC20_ADDR                  0x452
#define MSR_IA32_MC20_MISC                  0x453
#define MSR_IA32_MC21_CTL                   0x454
#define MSR_IA32_MC21_STATUS                0x455
#define MSR_IA32_MC21_ADDR                  0x456
#define MSR_IA32_MC21_MISC                  0x457
#define MSR_IA32_MC22_CTL                   0x458
#define MSR_IA32_MC22_STATUS                0x459
#define MSR_IA32_MC22_ADDR                  0x45A
#define MSR_IA32_MC22_MISC                  0x45B
#define MSR_IA32_MC23_CTL                   0x45C
#define MSR_IA32_MC23_STATUS                0x45D
#define MSR_IA32_MC23_ADDR                  0x45E
#define MSR_IA32_MC23_MISC                  0x45F
#define MSR_IA32_MC24_CTL                   0x460
#define MSR_IA32_MC24_STATUS                0x461
#define MSR_IA32_MC24_ADDR                  0x462
#define MSR_IA32_MC24_MISC                  0x463
#define MSR_IA32_MC25_CTL                   0x464
#define MSR_IA32_MC25_STATUS                0x465
#define MSR_IA32_MC25_ADDR                  0x466
#define MSR_IA32_MC25_MISC                  0x467
#define MSR_IA32_MC26_CTL                   0x468
#define MSR_IA32_MC26_STATUS                0x469
#define MSR_IA32_MC26_ADDR                  0x46A
#define MSR_IA32_MC26_MISC                  0x46B
#define MSR_IA32_MC27_CTL                   0x46C
#define MSR_IA32_MC27_STATUS                0x46D
#define MSR_IA32_MC27_ADDR                  0x46E
#define MSR_IA32_MC27_MISC                  0x46F
#define MSR_IA32_MC28_CTL                   0x470
#define MSR_IA32_MC28_STATUS                0x471
#define MSR_IA32_MC28_ADDR                  0x472
#define MSR_IA32_MC28_MISC                  0x473
#define MSR_IA32_VMX_BASIC                  0x480
#define MSR_IA32_VMX_PINBASED_CTLS          0x481
#define MSR_IA32_VMX_PROCBASED_CTLS         0x482
#define MSR_IA32_VMX_EXIT_CTLS              0x483
#define MSR_IA32_VMX_ENTRY_CTLS             0x484
#define MSR_IA32_VMX_MISX                   0x485
#define MSR_IA32_VMX_CR0_FIXED0             0x486
#define MSR_IA32_VMX_CR0_FIXED1             0x487
#define MSR_IA32_VMX_CR4_FIXED0             0x488
#define MSR_IA32_VMX_CR4_FIXED1             0x489
#define MSR_IA32_VMX_VMCS_ENUM              0x48A
#define MSR_IA32_VMX_PROCBASED_CTLS2        0x48B
#define MSR_IA32_VMX_EPT_VPID_CAP           0x48C
#define MSR_IA32_VMX_TRUE_PINBASED_CTLS     0x48D
#define MSR_IA32_VMX_TRUE_PROCBASED_CTLS    0x48E
#define MSR_IA32_VMX_TRUE_EXIT_CTLS         0x48F
#define MSR_IA32_VMX_TRUE_ENTRY_CTLS        0x490
#define MSR_IA32_VMX_VMFUNC                 0x491
#define MSR_IA32_A_PMC0                     0x4C1
#define MSR_IA32_A_PMC1                     0x4C2
#define MSR_IA32_A_PMC2                     0x4C3
#define MSR_IA32_A_PMC3                     0x4C4
#define MSR_IA32_A_PMC4                     0x4C5
#define MSR_IA32_A_PMC5                     0x4C6
#define MSR_IA32_A_PMC6                     0x4C7
#define MSR_IA32_A_PMC7                     0x4C8
#define MSR_IA32_MCG_EXT_CTL                0x4D0
#define MSR_IA32_SGX_SVN_STATUS             0x500
#define MSR_IA32_RTIT_OUTPUT_BASE           0x560
#define MSR_IA32_RTIT_OUTPUT_MASK_PTRS      0x561
#define MSR_IA32_RTIT_CTL                   0x570
#define MSR_IA32_RTIT_STATUS                0x571
#define MSR_IA32_RTIT_CR3_MATCH             0x572
#define MSR_IA32_RTIT_ADDR0_A               0x580
#define MSR_IA32_RTIT_ADDR0_B               0x581
#define MSR_IA32_RTIT_ADDR1_A               0x582
#define MSR_IA32_RTIT_ADDR1_B               0x583
#define MSR_IA32_RTIT_ADDR2_A               0x584
#define MSR_IA32_RTIT_ADDR2_B               0x585
#define MSR_IA32_RTIT_ADDR3_A               0x586
#define MSR_IA32_RTIT_ADDR3_B               0x587
#define MSR_IA32_DS_AREA                    0x600
#define MSR_IA32_U_CET                      0x6A0
#define MSR_IA32_S_CET                      0x6A2
#define MSR_IA32_PL0_SSP                    0x6A4
#define MSR_IA32_PL1_SSP                    0x6A5
#define MSR_IA32_PL2_SSP                    0x6A6
#define MSR_IA32_PL3_SSP                    0x6A7
#define MSR_IA32_INTERRUPT_SSP_TABLE_ADDR   0x6A8
#define MSR_IA32_TSC_DEADLINE               0x6E0
#define MSR_IA32_PKRS                       0x6E1
#define MSR_IA32_PM_ENABLE                  0x770
#define MSR_IA32_HWP_CAPABILITIES           0x771
#define MSR_IA32_HWP_REQUEST_PKG            0x772
#define MSR_IA32_HWP_INTERRUPT              0x773
#define MSR_IA32_HWP_REQUEST                0x774
#define MSR_IA32_PECI_HWP_REQUEST_INFO      0x775
#define MSR_IA32_HWP_STATUS                 0x777
#define MSR_IA32_X2APIC_APICID              0x802
#define MSR_IA32_X2APIC_VERSION             0x803
#define MSR_IA32_X2APIC_TPR                 0x808
#define MSR_IA32_X2APIC_PPR                 0x80A
#define MSR_IA32_X2APIC_EOI                 0x80B
#define MSR_IA32_X2APIC_LDR                 0x80D
#define MSR_IA32_X2APIC_SIVR                0x80F
#define MSR_IA32_X2APIC_ISR0                0x810
#define MSR_IA32_X2APIC_ISR1                0x811
#define MSR_IA32_X2APIC_ISR2                0x812
#define MSR_IA32_X2APIC_ISR3                0x813
#define MSR_IA32_X2APIC_ISR4                0x814
#define MSR_IA32_X2APIC_ISR5                0x815
#define MSR_IA32_X2APIC_ISR6                0x816
#define MSR_IA32_X2APIC_ISR7                0x817
#define MSR_IA32_X2APIC_TMR0                0x818
#define MSR_IA32_X2APIC_TMR1                0x819
#define MSR_IA32_X2APIC_TMR2                0x81A
#define MSR_IA32_X2APIC_TMR3                0x81B
#define MSR_IA32_X2APIC_TMR4                0x81C
#define MSR_IA32_X2APIC_TMR5                0x81D
#define MSR_IA32_X2APIC_TMR6                0x81E
#define MSR_IA32_X2APIC_TMR7                0x81F
#define MSR_IA32_X2APIC_IRR0                0x820
#define MSR_IA32_X2APIC_IRR1                0x821
#define MSR_IA32_X2APIC_IRR2                0x822
#define MSR_IA32_X2APIC_IRR3                0x823
#define MSR_IA32_X2APIC_IRR4                0x824
#define MSR_IA32_X2APIC_IRR5                0x825
#define MSR_IA32_X2APIC_IRR6                0x826
#define MSR_IA32_X2APIC_IRR7                0x827
#define MSR_IA32_X2APIC_ESR                 0x828
#define MSR_IA32_X2APIC_LVT_CMCI            0x82F
#define MSR_IA32_X2APIC_ICR                 0x830
#define MSR_IA32_X2APIC_LVT_TIMER           0x832
#define MSR_IA32_X2APIC_LVT_THERMAL         0x833
#define MSR_IA32_X2APIC_LVT_PMI             0x934
#define MSR_IA32_X2APIC_LVT_LINT0           0x835
#define MSR_IA32_X2APIC_LVT_LINT1           0x836
#define MSR_IA32_X2APIC_LVT_ERROR           0x837
#define MSR_IA32_X2APIC_INIT_COUNT          0x838
#define MSR_IA32_X2APIC_CUR_COUNT           0x839
#define MSR_IA32_X2APIC_DIV_CONF            0x83E
#define MSR_IA32_X2APIC_SELD_IPI            0x93F
#define MSR_IA32_DEBUG_INTERFACE            0xC80
#define MSR_IA32_L3_QOS_CFG                 0xC81
#define MSR_IA32_L2_QOS_CFG                 0xC82
#define MSR_IA32_QM_EVTSEL                  0xC8D
#define MSR_IA32_QM_CTR                     0xC8E
#define MSR_IA32_PQR_ASSOC                  0xC8F

/* C90H-D8FH Reserved Address Space for CAT Mask Registers
    See Section 17.19.4.1 "Enumeration
    and Detection Support of Cache
    Allocation Technology".
*/
#define MSR_IA32_L3_MASK_0                  0xC90
#define MSR_IA32_L3_MASK_n                  0xC90+n

/* D10H-D4FF : Reserved MSR Address Space for L2 CAT mask Registers
    See Section 17.19.4.1 "Enumeration
    and Detection Support of Cache
    Allocation Technology".
*/
#define MSR_IA32_L2_MASK_0                  0xD10
#define MSR_IA32_L2_MASK_n                  0xD10+n
#define MSR_IA32_BNDCFGS                    0xD90
#define MSR_IA32_XSS                        0xDA0
#define MSR_IA32_PKG_HDC_CTL                0xDB0
#define MSR_IA32_PM_CTL1                    0xDB1
#define MSR_IA32_THREAD_STALL               0xDB2
#define MSR_IA32_HW_FEEEDBACK_PTR           0x17D0
#define MSR_IA32_HW_FEEDBACK_CONFIG         0x17D1

/* 40000000H-400000FFH : Reserved MSR Address Space
    All existing and future procesors
    will not implement MSRs in this
    range.
*/
#define MSR_IA32_EFER                       0xC0000080
#define MSR_IA32_STAR                       0xC0000081
#define MSR_IA32_LSTAR                      0xC0000082
#define MSR_IA32_CSTAR                      0xC0000083
#define MSR_IA32_FMASK                      0xC0000084
#define MSR_IA32_FS_BASE                    0xC0000100
#define MSR_IA32_GS_BASE                    0xC0000101
#define MSR_IA32_KERNEL_GS_BASE             0xC0000102
#define MSR_IA32_TSC_AUX                    0xC0000103

#ifdef __cplusplus
}
#endif // __cplusplus

#endif  // _KRNL_MSR_H